# 插件

插件通常会为 VuePress 添加全局功能。插件的范围没有限制。你可以在 [Awesome VuePress (opens new window)](https://github.com/vuepressjs/awesome-vuepress#plugins)中找到更多的插件。

## [#](https://vuepress.vuejs.org/zh/plugin/#样例)样例

以下是几种比较常见的插件：

1. 拓展在编译期生成的页面元数据，如：[@vuepress/plugin-last-updated](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html)；
2. 在编译前后生成额外的文件，如：[@vuepress/plugin-pwa](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html)；
3. 注入全局的 UI, 如：[@vuepress/plugin-back-to-top](https://vuepress.vuejs.org/zh/plugin/official/plugin-back-to-top.html);
4. 拓展 CLI 的指令，如：[vuepress-plugin-export (opens new window)](https://github.com/ulivz/vuepress-plugin-export)。

这里也有一个略微复杂的插件案例 [@vuepress/plugin-blog (opens new window)](https://vuepress-plugin-blog.billyyyyy3320.com/)，其使用了编译期的元数据来生成了一些动态模块，并在客户端使用 `enhanceAppFiles` 来初始化他们。

## [#](https://vuepress.vuejs.org/zh/plugin/#开箱即用)开箱即用

为了让项目尽可能地简洁，并非所有官方插件都会随着 VuePress 一同安装。以下是一些随着 VuePress 和默认主题一同安装的插件，**没有出现在下表中的插件需要手动安装**（比如：[@vuepress/plugin-back-to-top](https://vuepress.vuejs.org/zh/plugin/official/plugin-back-to-top.html)）。

### [#](https://vuepress.vuejs.org/zh/plugin/#vuepress-自带的插件)VuePress 自带的插件

- [@vuepress/plugin-last-updated](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html)
- [@vuepress/plugin-register-components](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html)

### [#](https://vuepress.vuejs.org/zh/plugin/#默认主题自带的插件)默认主题自带的插件

- [@vuepress/plugin-active-header-links](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html)
- [@vuepress/plugin-nprogress](https://vuepress.vuejs.org/zh/plugin/official/plugin-nprogress.html)
- [@vuepress/plugin-search](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html)
- [vuepress-plugin-container(opens new window)](https://vuepress-community.netlify.app/zh/plugins/container/#vuepress-plugin-container)
- [vuepress-plugin-smooth-scroll(opens new window)](https://vuepress-community.netlify.app/zh/plugins/smooth-scroll/#vuepress-plugin-smooth-scroll)

## [#](https://vuepress.vuejs.org/zh/plugin/#架构)架构

整个插件系统的架构如下:

![Architecture of VuePress](D:/hgx%E7%AC%94%E8%AE%B0/hgxbijiben/2%E3%80%81%E7%BC%96%E7%A8%8B%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%EF%BC%88%E7%9B%AE%E5%89%8D%E5%B7%B2%E7%BB%8F%E5%85%A8%E9%83%A8%E4%BA%86%E8%A7%A3%E5%AE%8C%E4%BA%86%EF%BC%89/Vuepress/architecture.png)

# 使用插件

你可以通过在 `.vuepress/config.js` 中做一些配置来使用插件：

```js
module.exports = {
  plugins: [
    require('./my-plugin.js')
  ]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html#使用来自依赖的插件)使用来自依赖的插件

一个插件可以在以 `vuepress-plugin-xxx` 的形式发布到 npm，你可以这样使用它：

```js
module.exports = {
  plugins: [ 'vuepress-plugin-xx' ]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html#插件的缩写)插件的缩写

如果你的插件名以 `vuepress-plugin-` 开头，你可以使用缩写来省略这个前缀：

```js
module.exports = {
  plugins: [ 'xxx' ]
}
```

和下面等价：

```js
module.exports = {
  plugins: [ 'vuepress-plugin-xxx' ]
}
```

这也适用于 [Scoped Packages (opens new window)](https://docs.npmjs.com/misc/scope):

```js
module.exports = {
  plugins: [ '@org/vuepress-plugin-xxx', '@vuepress/plugin-xxx' ]
}
```

等价于:

```js
module.exports = {
  plugins: [ '@org/xxx', '@vuepress/xxx' ]
}
```

注意

以 `@vuepress/plugin-` 开头的插件是官方维护的插件。

## [#](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html#插件的选项)插件的选项

### [#](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html#babel-式)Babel 式

插件可以通过在配置内的数组中封装名称和选项对象来指定选项：

```js
module.exports = {
  plugins: [
    [
      'vuepress-plugin-xxx',
      { /* options */ }
    ]
  ]
}
```

由于这种风格和 [babeld Plugin/Preset Options (opens new window)](https://babeljs.io/docs/en/plugins#plugin-preset-options)一致，我们称之为"Babel 风格"。

### [#](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html#对象式)对象式

VuePress 也提供了一种更简单的方式来使用来自依赖的插件：

```js
module.exports = {
  plugins: {
    'xxx': { /* options */ }
  }
}
```

注意

可以通过显示地将选项设置成 `false` 来禁用一个插件：

- Babel 风格

```js
module.exports = {
  plugins: [
    [ 'xxx', false ] // disabled.
  ]
}
```

- 对象风格

```js
module.exports = {
  plugins: {
    'xxx': false // disabled.
  }
}
```

# 开发插件

一个插件应该导出一个普通的 JavaScript 对象（`#1`），如果插件需要接受配置选项，那么它可以是一个返回对象的函数（`#2`），这个函数接受插件的配置选项为第一个参数、包含编译期上下文的 [ctx](https://vuepress.vuejs.org/zh/plugin/context-api.html) 对象作为第二个参数。

```js
// #1
module.exports = {
   // ...
}
// #2
module.exports = (options, ctx) => {
   return {
      // ...
   }
}
```

提示

一个 VuePress 插件应该是一个 `CommonJS 模块`，因为 VuePress 插件运行在 Node 端。

# 生命周期

## [#](https://vuepress.vuejs.org/zh/plugin/life-cycle.html#ready)ready

- 类型: `AsyncFunction`
- 作用域：`dev|build`

```js
module.exports = {
  async ready() {
    // ...
  }
}
```

提示

`ready` 钩子在应用初始化之后，并在某些特定的函数式 API 执行之前执行。这些函数式 API 包括：

- [clientDynamicModules](https://vuepress.vuejs.org/zh/plugin/option-api.html#clientdynamicmodules)
- [enhanceAppFiles](https://vuepress.vuejs.org/zh/plugin/option-api.html#enhanceappfiles)

## [#](https://vuepress.vuejs.org/zh/plugin/life-cycle.html#updated)updated

- 类型: `Function`
- 作用域：`dev`

```js
module.exports = {
  updated() {
    // ...
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/life-cycle.html#generated)generated

- 类型: `AsyncFunction`
- 作用域：`build`

在生产环境的构建结束后被调用，生成的页面的路径数组将作为该函数的第一个参数。

```js
module.exports = {
  async generated (pagePaths) {
    // ...
  }
}
```



# Option API

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#name)name

- 类型: `string`
- 默认值: undefined

插件的名字。

在内部，VuePress 将会使用插件的包名作为插件的名称。当你的插件是一个本地插件（即直接使用了一个纯函数）时，请确保设定了该选项，这对调试更有利。

```js
// .vuepress/config.js
module.exports = {
  plugins: [
    [
      (pluginOptions, context) => ({
        name: 'my-xxx-plugin'
        // ... the rest of options
      })
    ]
  ]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#plugins)plugins

- 类型: `array`
- 默认值: undefined

一个插件可以像 preset 一样包含多个插件。

```js
// 一个插件
module.exports = {
  plugins: [
    'tag',
    'category'
  ]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#chainwebpack)chainWebpack

- 类型: `Function`
- 默认值: undefined

使用 [webpack-chain (opens new window)](https://github.com/mozilla-neutrino/webpack-chain)来修改内部的 webpack 配置：

```js
module.exports = {
  chainWebpack (config, isServer) {
    // config 是一个 ChainableConfig 的实例
  }
}
```

提示

由于 VuePress 是一个基于 Vue-SSR 的应用，这里会有两个 webpack 配置，`isServer` 用于决定当前的 webpack 配置是应用到 server 还是 client。

**参考:**

- [Vue SSR > 构建配置(opens new window)](https://ssr.vuejs.org/zh/guide/build-config.html)

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#define)define

- 类型: `Object|Function`
- 默认值: undefined

由于通过 [chainWebpack](https://vuepress.vuejs.org/zh/plugin/option-api.html#chainwebpack) 使用 [DefinePlugin (opens new window)](https://webpack.js.org/plugins/define-plugin/)会有点麻烦：

```js
module.exports = {
  chainWebpack (config) {
    config.plugin('injections').tap(([options]) => [
      Object.assign(options, {
        SW_BASE_URL: JSON.stringify('/')
      })
    ])
  }
}
```

VuePress 特别开辟了一个更简洁的 `define` 选项。值得注意的是这些值已自动地被 `JSON.stringify` 处理。

- 对象式:

```js
module.exports = {
  define: {
    SW_BASE_URL: '/',
  }
}
```

- 函数式:

```js
module.exports = (options, context) => ({
  define () {
    return {
      SW_BASE_URL: context.base || '/',
      SW_ENABLED: !!options.enabled,
    }
  }
})
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#alias)alias

- 类型: `Object|Function`
- 默认值: undefined

我们可以通过 [chainWebpack](https://vuepress.vuejs.org/zh/plugin/option-api.html#chainwebpack) 来配置别名：

```js
module.exports = (options, context) => ({
  chainWebpack (config) {
    config.resolve.alias.set('@pwd', process.cwd())
  }
})
```

`alias` 可以使这个流程更像配置：

```js
module.exports = (options, context) => ({
  alias: {
    '@theme': context.themeAPI.themePath
  }
})
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#beforedevserver)beforeDevServer

- 类型: `Function`
- 默认值: undefined

等同于 [webpack-dev-server (opens new window)](https://github.com/webpack/webpack-dev-server)中的 [before (opens new window)](https://webpack.js.org/configuration/dev-server/#devserver-before)选项，你可以使用它来自定义你的 devServer，如：

```js
module.exports = {
  // ...
  beforeDevServer(app, server) {
    app.get('/path/to/your/custom', function(req, res) {
      res.json({ custom: 'response' })
    })
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#afterdevserver)afterDevServer

- 类型: `Function`
- 默认值: undefined

等同于 [webpack-dev-server (opens new window)](https://github.com/webpack/webpack-dev-server)中的 [after (opens new window)](https://webpack.js.org/configuration/dev-server/#devserver-after)，你可以用其在所有中间件的最后去执行一些自定义的中间件：

```js
module.exports = {
  // ...
  afterDevServer(app, server) {
    // hacking now ...
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#extendmarkdown)extendMarkdown

- 类型: `Function`
- 默认值: `undefined`

一个函数，修改内部用于渲染 markdown 文件的 [markdown-it (opens new window)](https://github.com/markdown-it/markdown-it)实例的配置、或者应用一些额外的插件：

```js
module.exports = {
  extendMarkdown: md => {
    md.set({ breaks: true })
    md.use(require('markdown-it-xxx'))
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#chainmarkdown)chainMarkdown

- 类型: `Function`
- 默认值: `undefined`

使用 [markdown-it-chain (opens new window)](https://github.com/ulivz/markdown-it-chain)来修改内部的 markdown 配置。

```js
module.exports = {
  chainMarkdown (config) {
    // 与 new MarkdownIt 的 'options' 互动
    // 参考: https://markdown-it.github.io/markdown-it/#MarkdownIt.new
    config
      .options
        .link(true)
        .breaks(true)

    // 修改内置插件的参数
    config
      .plugin('anchor')
        .tap(([options]) => [
          Object.assign(options, { permalinkSymbol: '#' })
        ])

    // 增加额外的插件
    config
      .plugin('sup')
        .use(require('markdown-it-sup'))

    // Remove internal plugin
    config.plugins.delete('snippet')
  }
}
```

**参考:**

- [VuePress 的内置 markdown-it 插件(opens new window)](https://github.com/vuejs/vuepress/blob/master/packages/%40vuepress/markdown/index.js)
- [配置插件(opens new window)](https://github.com/neutrinojs/webpack-chain#config-plugins)

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#enhanceappfiles)enhanceAppFiles

- 类型: `String | Array | AsyncFunction`
- 默认值: `undefined`

此选项接受指向增强文件的绝对文件路径或返回该路径的函数，你可以通过此选项做一些[应用级别的配置](https://vuepress.vuejs.org/zh/guide/basic-config.html#应用级别的配置):

```js
import { resolve } from 'path'

module.exports = {
  enhanceAppFiles: resolve(__dirname, 'client.js')
}
```

此选项还支持动态代码，允许你使用贴近编译上下文的能力来做更多的事：

```js
module.exports = (option, context) => {
  return {
    enhanceAppFiles() {
      return {
         name: 'dynamic-code',
         content: `export default ({ Vue }) => { Vue.mixin('$source', '${
           context.sourceDir
         }') }`
       }
    }
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#clientdynamicmodules)clientDynamicModules

- 类型: `Function`
- 默认值: `undefined`

有时，你可能想要在编译期间生成一些在客户端使用的模块：

```js
module.exports = (options, context) => ({
  clientDynamicModules() {
    return {
      name: 'constants.js',
      content: `export const SOURCE_DIR = '${context.sourceDir}'`
    }
  }
})
```

然后你可以在客户端这样使用你的模块：

```js
import { SOURCE_DIR } from '@dynamic/constants'
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#extendpagedata)extendPageData

- 类型: `Function`
- 默认值: `undefined`

一个函数，用于拓展或者修改 [$page](https://vuepress.vuejs.org/zh/guide/global-computed.html#page) 对象。这个函数将会在编译期为每个页面执行一次。

```js
module.exports = {
  extendPageData ($page) {
    const {
      _filePath,           // 源文件的绝对路径
      _computed,           // 在构建期访问全局的计算属性，如：_computed.$localePath.
      _content,            // 源文件的原始内容字符串
      _strippedContent,    // 源文件剔除掉 frontmatter 的内容字符串
      key,                 // 页面唯一的 hash key
      frontmatter,         // 页面的 frontmatter 对象
      regularPath,         // 当前页面遵循文件层次结构的默认链接
      path,                // 当前页面的实际链接（在 permalink 不存在时，使用 regularPath ）
    } = $page

    // 1. Add extra fields.
    $page.xxx = 'xxx'

    // 2. Change frontmatter.
    frontmatter.sidebar = 'auto'
  }
}
```

注意

那些以 `_` 开头的字段意味着你只能在编译期访问。

例子：

```js
module.exports = {
  extendPageData ($page) {
    $page.size = ($page._content.length / 1024).toFixed(2) + 'kb'
  }
}
```

然后你可以在任意的 Vue 中通过 `this.$page.size` 来访问这个变量。

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#clientrootmixin)clientRootMixin

- 类型: `String`
- 默认值: `undefined`

指向 `mixin` 文件的路径，它让你可以控制根组件的生命周期：

```js
// 插件的入口
const path = require('path')

module.exports = {
  clientRootMixin: path.resolve(__dirname, 'mixin.js')
}
// mixin.js
export default {
  created () {},
  mounted () {}
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#additionalpages)additionalPages

- 类型: `Array|AsyncFunction`
- 默认值: `undefined`

增加一个指向某个 markdown 文件的页面：

```js
const path = require('path')

module.exports = {
  additionalPages: [
    {
     path: '/readme/',
     filePath: path.resolve(__dirname, '../../README.md')
    }
  ]
}
```

或增加一个具有明确内容的页面：

```js
module.exports = {
  async additionalPages () {
    // 注意 VuePress 没有任何内置的请求库，
    // 你需要自己安装它。
    const rp = require('request-promise')
    const content = await rp('https://raw.githubusercontent.com/vuejs/vuepress/master/CHANGELOG.md')
    return [
      {
        path: '/changelog/',
        content
      }
    ]
  }
}
```

或增加一个纯粹的路由：

```js
module.exports = {
  additionalPages: [
    {
       path: '/alpha/',
       frontmatter: {
          layout: 'MyLayout'
       }
    }
  ]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#globaluicomponents)globalUIComponents

- 类型: `Array|String`
- 默认值: `undefined`

你可能想注入某些全局的 UI，并固定在页面中的某处，如 `back-to-top`, `popup`。在 VuePress 中，**一个全局 UI 就是一个 Vue 组件**。你可以直接配置该全局组件的名称，如：

```js
module.exports = {
  globalUIComponents: [
    'Component-1',
    'Component-2'
  ]
}
```

VuePress 将会自动将这些组件注入到布局组件的隔壁：

```html
<div id="app">
  <div class="theme-container"> ... </div> <!-- Layout Component -->
  <div class="global-ui">
    <Component-1/>
    <Component-2/>
</div>
</div>
```

## [#](https://vuepress.vuejs.org/zh/plugin/option-api.html#extendcli)extendCli

- 类型: `function`
- 默认值: `undefined`

注册一个额外的 command 来增强 VuePress 的 CLI。这个函数将会以一个 [CAC (opens new window)](https://github.com/cacjs/cac)的实例作为第一个参数被调用。

```js
module.exports = {
  extendCli (cli) {
    cli
      .command('info [targetDir]', '')
      .option('--debug', 'display info in debug mode')
      .action((dir = '.') => {
        console.log('Display info of your website')
      })
  }
}
```

现在你可以在你项目中使用 `vuepress info [targetDir]` 了！

提示

值得注意的是，一个自定义的 command 需要 VuePress 像 `vuepress dev` 或 `vuepress build` 去定位到你的站点配置，所以在开发一个 command 时，请确保引导用户去传入 `targetDir` 作为 CLI 参数的一部分。



# Context API

VuePress 提供了一个存储了当前页面所有状态的 Context API。

提示

每个函数式插件的上下文对象是一个继承于根上下文的隔离上下文对象。

```js
module.exports = (options, ctx) => {
  // ...
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-isprod)ctx.isProd

- 类型: `boolean`

VuePress 是否运行在生产环境模式下。

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-pages)ctx.pages

- 类型: `array`

一个包含了页面对象的列表。

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-sourcedir)ctx.sourceDir

- 类型: `string`

文档的根目录路径。

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-temppath)ctx.tempPath

- 类型: `string`

临时文件所在的根目录路径。

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-outdir)ctx.outDir

- 类型: `string`

输出目录。

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-base)ctx.base

- 类型: `string`

参考: [base](https://vuepress.vuejs.org/zh/config/#base).

## [#](https://vuepress.vuejs.org/zh/plugin/context-api.html#ctx-writetemp)ctx.writeTemp

- 类型: `Function`

一个用于向 tempPath 写入临时文件的方法。

# [@vuepress/plugin-active-header-links(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-active-header-links)

> 页面滚动时自动激活侧边栏链接的插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#安装)安装

```bash
yarn add -D @vuepress/plugin-active-header-links
# OR npm install -D @vuepress/plugin-active-header-links
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/active-header-links']
}
```

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#配置选项)配置选项

```javascript
module.exports = {
  plugins: ['@vuepress/active-header-links', {
    sidebarLinkSelector: '.sidebar-link',
    headerAnchorSelector: '.header-anchor'
  }]
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#sidebarlinkselector)sidebarLinkSelector

- 类型: `string`
- 默认值: `.sidebar-link`

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html#headeranchorselector)headerAnchorSelector

- 类型: `string`
- 默认值: `.header-anchor`



# [@vuepress/plugin-back-to-top(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-back-to-top)

> back-to-top 插件.

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-back-to-top.html#安装)安装

```bash
yarn add -D @vuepress/plugin-back-to-top
# OR npm install -D @vuepress/plugin-back-to-top
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-back-to-top.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/back-to-top']
}
```



# [@vuepress/plugin-blog(opens new window)](https://github.com/vuepressjs/vuepress-plugin-blog)

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-blog.html#功能)功能

- [**分类** (opens new window)](https://vuepress-plugin-blog.billyyyyy3320.com/guide/getting-started.html#document-classifier)：强大的分类系统让你快速将贴文分类。
- [**分页** (opens new window)](https://vuepress-plugin-blog.billyyyyy3320.com/guide/getting-started.html#pagination)： 极其简单的开箱即用的分页功能。
- [**客户端 API** (opens new window)](https://vuepress-plugin-blog.billyyyyy3320.com/client-api/): 透过客户端 API 轻松地写一个博客主题。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-blog.html#安装)安装

在使用这个插件之前，我们强烈建议你先阅读 [Getting Started (opens new window)](https://vuepress-plugin-blog.billyyyyy3320.com/guide/getting-started.html)。

```bash
yarn add -D @vuepress/plugin-blog
# OR npm install -D @vuepress/plugin-blog
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-blog.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/blog']
}
```

参考 [文档 (opens new window)](https://vuepress-theme-blog.billyyyyy3320.com/)来查看所有可用的选项。

# [@vuepress/plugin-google-analytics(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-google-analytics)

> Google analytics 插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-google-analytics.html#安装)安装

```bash
yarn add -D @vuepress/plugin-google-analytics
# OR npm install -D @vuepress/plugin-google-analytics
```

注意

如果你的项目正在使用 Google analytics 插件，推荐使用 [Yarn (opens new window)](https://yarnpkg.com/en/)而不是 npm 来安装所有依赖。因为在这种情形下，npm 会生成错误的依赖树。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-google-analytics.html#使用)使用

```javascript
module.exports = {
  plugins: [
    [
      '@vuepress/google-analytics',
      {
        'ga': '' // UA-00000000-0
      }
    ]
  ]
}
```

提示

请留意 [GDPR (2018年欧盟数据保护规则改革) (opens new window)](https://ec.europa.eu/commission/priorities/justice-and-fundamental-rights/data-protection/2018-reform-eu-data-protection-rules_en), 在合适或者需要的情况下，考虑将 Google Analytics 设置为[匿名化的 IP (opens new window)](https://support.google.com/analytics/answer/2763052?hl=zh-Hans)。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-google-analytics.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-google-analytics.html#ga)ga

- 类型: `string`
- 默认值: `undefined`

提供 Google Analytics ID 以启用集成。

# [@vuepress/plugin-last-updated(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-last-updated)

> last-updated 插件。

如果你使用默认主题，你无需安装本插件，因为 VuePress 的 `core` 中已经包含此插件，同时，你应该直接使用 [themeConfig.lastUpdated](https://vuepress.vuejs.org/zh/theme/default-theme-config.html#最后更新时间) 选项。

如果你在你的自定义主题中使用该插件，你将需要自己在主题中完成 lastUpdated 的 UI，你可以使用 **[$page.lastUpdated](https://vuepress.vuejs.org/zh/guide/global-computed.html#page)** 去访问当前页面的时间字符串。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html#使用)使用

```js
module.exports = {
  plugins: ['@vuepress/last-updated']
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html#transformer)transformer

- 类型: `(timestamp: number, lang: string) => string`
- 默认值: `undefined`

默认情况下，本插件为每个页面生成一个 13 位的时间戳，你可以传入一个 transformer 将其转换为你想要的任何格式。

例子：

```javascript
const moment = require('moment');

module.exports = {
  plugins: [
    [
      '@vuepress/last-updated',
      {
        transformer: (timestamp, lang) => {
          // 不要忘了安装 moment
          const moment = require('moment')
          moment.locale(lang)
          return moment(timestamp).fromNow()
        }
      }
    ]
  ]
}
```

提示

如果你在[多语言](https://vuepress.vuejs.org/zh/guide/i18n.html)模式下运行，你还可以使用第二个参数 `lang` 为不同语言生成时间字符串。

请注意，在 VuePress 中，我们遵循以下规范：[W3C > Language tags in HTML and XML (opens new window)](https://en.wikipedia.org/wiki/Language_localisation)，因此 `zh-CN` 使用连字符（`-`）而不是下划线（`_`）。 请确保你使用的库遵循此规范，否则请自行转换。

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html#dateoptions)dateOptions

- 类型: `object`
- 默认值: `undefined`

你也可以传入一个对象作为选项，以自定义时间戳的输出格式。详细信息请参阅 [`Date.prototype.toLocaleString()` (opens new window)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString)的选项参数。

```javascript
module.exports = {
  plugins: [
    [
      '@vuepress/last-updated',
      {
        dateOptions:{
          hour12: false
        }
      }
    ]
  ]
}
```


``

[指南](https://vuepress.vuejs.org/zh/guide/)

[配置](https://vuepress.vuejs.org/zh/config/)

[插件](https://vuepress.vuejs.org/zh/plugin/)

[主题](https://vuepress.vuejs.org/zh/theme/)

了解更多 

v1.x 

选择语言 

 [GitHub (opens new window)](https://github.com/vuejs/vuepress)

- 插件
  - [介绍](https://vuepress.vuejs.org/zh/plugin/)
  - [使用插件](https://vuepress.vuejs.org/zh/plugin/using-a-plugin.html)
  - [开发插件](https://vuepress.vuejs.org/zh/plugin/writing-a-plugin.html)
  - [生命周期](https://vuepress.vuejs.org/zh/plugin/life-cycle.html)
  - [Option API](https://vuepress.vuejs.org/zh/plugin/option-api.html)
  - [Context API](https://vuepress.vuejs.org/zh/plugin/context-api.html)
- 官方插件
  - [active-header-links](https://vuepress.vuejs.org/zh/plugin/official/plugin-active-header-links.html)
  - [back-to-top](https://vuepress.vuejs.org/zh/plugin/official/plugin-back-to-top.html)
  - [blog](https://vuepress.vuejs.org/zh/plugin/official/plugin-blog.html)
  - [google-analytics](https://vuepress.vuejs.org/zh/plugin/official/plugin-google-analytics.html)
  - [last-updated](https://vuepress.vuejs.org/zh/plugin/official/plugin-last-updated.html)
  - medium-zoom
    - [安装](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#安装)
    - [使用](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#使用)
    - [选项](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#选项)
  - [nprogress](https://vuepress.vuejs.org/zh/plugin/official/plugin-nprogress.html)
  - [pwa](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html)
  - [register-components](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html)
  - [search](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html)

# [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#vuepress-plugin-medium-zoom)[@vuepress/plugin-medium-zoom(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-medium-zoom)

> [medium-zoom (opens new window)](https://github.com/francoischalifour/medium-zoom)插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#安装)安装

```bash
yarn add -D @vuepress/plugin-medium-zoom
# OR npm install -D @vuepress/plugin-medium-zoom
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#使用)使用

**简单使用**:

```javascript
module.exports = {
  plugins: ['@vuepress/medium-zoom']
}
```

**自定义选项**:

```javascript
module.exports = {
  plugins: {
    '@vuepress/medium-zoom': {
      selector: 'img.zoom-custom-imgs',
      // medium-zoom options here
      // See: https://github.com/francoischalifour/medium-zoom#options
      options: {
        margin: 16
      }
    }
  }
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#selector)selector

- 类型: `string`
- 默认值: `.theme-default-content :not(a) > img`

值得注意的是， `.theme-default-content` 是默认主题添加给 [``](https://vuepress.vuejs.org/zh/guide/using-vue.html#content) 组件的 class name。

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html#options)options

- 类型: `object`
- 默认值: `undefined`

[medium-zoom (opens new window)](https://github.com/francoischalifour/medium-zoom)的 [选项 (opens new window)](https://github.com/francoischalifour/medium-zoom#options)。

# [@vuepress/plugin-nprogress(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/%40vuepress/plugin-nprogress)

> 一个基于 [nprogress (opens new window)](https://github.com/rstacruz/nprogress)的进度条插件。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-nprogress.html#安装)安装

```bash
yarn add -D @vuepress/plugin-nprogress
# 或者 npm install -D @vuepress/plugin-nprogress
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-nprogress.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/nprogress']
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-nprogress.html#自定义颜色)自定义颜色

在你的 **site** 或 **theme** 的 `palette.styl` 文件中设置 `$nprogressColor` 来改变进度条的颜色（默认使用 `$accentColor`）。

```stylus
// .vuepress/styles/palette.styl
// 或者
// .vuepress/theme/styles/palette.styl

$nprogressColor = red
```

**参考：**

- [配置 > Styling](https://vuepress.vuejs.org/zh/config/#styling)

# [@vuepress/plugin-pwa(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-pwa)

> PWA 插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#安装)安装

```bash
yarn add -D @vuepress/plugin-pwa
# OR npm install -D @vuepress/plugin-pwa
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/pwa']
}
```

提示

为了让你的网站完全地兼容 PWA，你需要:

- 在 `.vuepress/public` 提供 Manifest 和 icons
- 在 `.vuepress/config.js` 添加正确的 [head links](https://vuepress.vuejs.org/config/#head)(参见下面例子).

更多细节，请参见 [MDN docs about the Web App Manifest (opens new window)](https://developer.mozilla.org/en-US/docs/Web/Manifest).

这是一个在VuePress中完全地兼容 PWA 的例子：

```javascript
module.exports = {
  head: [
    ['link', { rel: 'icon', href: '/logo.png' }],
    ['link', { rel: 'manifest', href: '/manifest.json' }],
    ['meta', { name: 'theme-color', content: '#3eaf7c' }],
    ['meta', { name: 'apple-mobile-web-app-capable', content: 'yes' }],
    ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],
    ['link', { rel: 'apple-touch-icon', href: '/icons/apple-touch-icon-152x152.png' }],
    ['link', { rel: 'mask-icon', href: '/icons/safari-pinned-tab.svg', color: '#3eaf7c' }],
    ['meta', { name: 'msapplication-TileImage', content: '/icons/msapplication-icon-144x144.png' }],
    ['meta', { name: 'msapplication-TileColor', content: '#000000' }]
  ],
  plugins: ['@vuepress/pwa', {
      serviceWorker: true,
      updatePopup: true
  }],
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#serviceworker)serviceWorker

- 类型: `boolean`
- 默认值: `true`

如果设置为 `true`，VuePress 将自动生成并注册一个 [Service Worker (opens new window)](https://developers.google.com/web/fundamentals/primers/service-workers/)，用于缓存页面的内容以供离线使用（仅会在生产环境中启用）。

有一个别名化的模块 `@sw-event` 模块将会 emit 以下事件：

- `sw-ready`
- `sw-cached`
- `sw-updated`
- `sw-offline`
- `sw-error`

提示

只有在你能够使用 SSL 部署您的站点时才能启用此功能，因为 service worker 只能在 HTTPs 的 URL 下注册。

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#generateswconfig)generateSWConfig

- 类型: `object`
- 默认值: `{}`

workbox-build 的 [generateSW config (opens new window)](https://developers.google.com/web/tools/workbox/modules/workbox-build#full_generatesw_config)。

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#updatepopup)updatePopup

- 类型: `boolean|popupConfig`
- 默认值: `undefined`

类型 `popupConfig` 的定义如下：

```typescript
interface normalPopupConfig {
  message: string; // defaults to 'New content is available.'
  buttonText: string; // defaults to 'Refresh'
}

interface localedPopupConfig {
  [localePath: string]: normalPopupConfig
}

type popupConfig = normalPopupConfig | localedPopupConfig
```

本选项开启了一个用于刷新内容的弹窗。这个弹窗将会在站点有内容更新时显示出来，并提供了一个 `refresh` 按钮，允许用户立即刷新内容。

> 如果没有“刷新”按钮，则只有在所有的 [Clients (opens new window)](https://developer.mozilla.org/en-US/docs/Web/API/Clients)被关闭后，新的 Service Worker 才会处于活动状态。这意味着用户在关闭你网站的所有标签之前无法看到新内容。但是 `refresh` 按钮会立即激活新的 Service Worker。

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#popupcomponent)popupComponent

- 类型: `string`
- 默认值: `undefined`

用于替换默认弹出组件的自定义组件。

**参考:**

- [自定义 SW-Update Popup](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#自定义-sw-update-popup-的-ui)

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#从-0-x-迁移)从 0.x 迁移

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#service-worker)Service Worker

```diff
module.exports = {
- serviceWorker: true,
+ plugins: ['@vuepress/pwa']
}
```

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#sw-update-popup)SW-Update Popup

```diff
module.exports = {
  themeConfig: {
-   serviceWorker: {
-     updatePopup: {
-        message: "New content is available.",
-        buttonText: "Refresh"
-     }
-   }
  },
+  plugins: {
+   '@vuepress/pwa': {
+      serviceWorker: true,
+      updatePopup: {
+        message: "New content is available.",
+        buttonText: "Refresh"
+      }
+    }
+ }
}
```

如果你在 [i18n](https://vuepress.vuejs.org/zh/guide/i18n.html) 模式下:

```diff
module.exports = {
  themeConfig: {
    '/': {
-     serviceWorker: {
-       updatePopup: {
-         message: "New content is available.",
-         buttonText: "Refresh"
-       }
-     }
    },
    '/zh/': {
-     serviceWorker: {
-       updatePopup: {
-         message: "发现新内容可用",
-         buttonText: "刷新"
-       }
-     }
    }
  },
+  plugins: {
+    '@vuepress/pwa': {
+      serviceWorker: true,
+      updatePopup: {
+        '/': {
+          message: "New content is available.",
+          buttonText: "Refresh"
+        },
+        '/zh/': {
+          message: "发现新内容可用",
+          buttonText: "刷新"
+        }
+      }
+    }
+  }
```

值得一提的是本插件已经内置了上述的 i18n 配置，所以如果你想直接使用默认的 i18n，你可以将上面的配置缩写为：

```js
module.exports = {
  plugins: {
    '@vuepress/pwa': {
      serviceWorker: true,
      updatePopup: true
    }
  }
}
```

欢迎提交 PR 以增加默认的 [i18n 配置 (opens new window)](https://github.com/vuejs/vuepress/blob/master/packages/%40vuepress/plugin-pwa/lib/i18n.js).

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-pwa.html#自定义-sw-update-popup-的-ui)自定义 SW-Update Popup 的 UI

默认的 SW-Update Popup 组件提供了一个默认插槽，使您能够完全控制弹窗的外观。

首先，您需要在 `.vuepress/components` 中创建一个全局组件（例如`MySWUpdatePopup`)。 一个基于默认组件创建的简单组件如下：

```vue
<template>
  <SWUpdatePopup v-slot="{ enabled, reload, message, buttonText }">
    <div
      v-if="enabled"
      class="my-sw-update-popup">
      {{ message }}<br>
      <button @click="reload">{{ buttonText }}</button>
    </div>
  </SWUpdatePopup>
</template>

<script>
import SWUpdatePopup from '@vuepress/plugin-pwa/lib/SWUpdatePopup.vue'

export default {
  components: { SWUpdatePopup }
}
</script>

<style>
.my-sw-update-popup {
  text-align: right;
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #fff;
  font-size: 20px;
  padding: 10px;
  border: 5px solid #3eaf7c;
}

.my-sw-update-popup button {
  border: 1px solid #fefefe;
}
</style>
```

接着，更新你的插件配置：

```diff
module.exports = {
   plugins: {
    '@vuepress/pwa': {
       serviceWorker: true,
+      popupComponent: 'MySWUpdatePopup',
       updatePopup: true
     }
  }
}
```

**参考:**

- [VuePress > 使用组件](https://vuepress.vuejs.org/zh/guide/using-vue.html#使用组件)
- [Vue > 作用域插槽](https://cn.vuejs.org/v2/guide/components-slots.html#作用域插槽)

# [@vuepress/plugin-register-components(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/%40vuepress/plugin-register-components)

> 注册组件的插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#安装)安装

```bash
yarn add -D @vuepress/plugin-register-components
# OR npm install -D @vuepress/plugin-register-components
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#使用)使用

```javascript
module.exports = {
  plugins: ['@vuepress/register-components']
}
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#componentsdir)componentsDir

- 类型: `Array | String`
- 默认值: `[]`

在这个目录下的所有组件将会被注册为全局组件，组件的命名将遵循在 [.vuepress/components (opens new window)](https://vuepress.vuejs.org/guide/using-vue.html#using-components)中找到的组件的命名。

```js
module.exports = {
  plugins: [
    [
      '@vuepress/register-components',
      {
        componentsDir: somepath
      }
    ]
  ]
}
```

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#components)components

- 类型: `{ name: string, path: string }`
- 默认值: `[]`

通过明确的名称和路径来注册组件。

```js
module.exports = {
  plugins: [
    [
      '@vuepress/register-components',
      {
        components: [
          {
            name: 'V-Card',
            path: 'path/to/card.vue'
          }
        ]
      }
    ]
  ]
}
```

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-register-components.html#getcomponentname)getComponentName

- 类型: `(file: string) => string`
- 默认值: `file => file.replace(/\/|\\/g, '-')`

自定义 `componentsDir` 中注册的组件的名称。

# [@vuepress/plugin-search(opens new window)](https://github.com/vuejs/vuepress/tree/master/packages/@vuepress/plugin-search)

> 基于 [Headers](https://vuepress.vuejs.org/zh/miscellaneous/glossary.html#headers) 的搜索插件

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#安装)安装

```bash
yarn add -D @vuepress/plugin-search
# OR npm install -D @vuepress/plugin-search
```

提示

请注意，此插件已包含在**默认主题**中，你现在看到的搜索便是由本插件提供支持。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#使用)使用

1. 启用此插件：

```js
// .vuepress/config.js or themePath/index.js
module.exports = {
  plugins: [
    ['@vuepress/search', {
      searchMaxSuggestions: 10
    }]
  ]
}
```

1. 本插件将自动注入指向搜索组件的 webpack 别名 `@SearchBox`，以便您可以直接在 [layout](https://vuepress.vuejs.org/zh/miscellaneous/glossary.html#layout) 组件中使用它：

```vue
<template>
  <div class="foo-layout">
    <header>
      <SearchBox/>
    </header>
    <main>
      ...
    </main>
  </div>
</template>

<script>
import SearchBox from '@SearchBox'

export default {
  components: { SearchBox }
}
</script>
```

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#选项)选项

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#searchmaxsuggestions)searchMaxSuggestions

- 类型: `number`
- 默认值: 5

设置搜索的最大结果数。

## [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#技巧)技巧

### [#](https://vuepress.vuejs.org/zh/plugin/official/plugin-search.html#调整默认颜色)调整默认颜色

由于该搜索组件使用了内置调色板，你可以通过 `styles/palette.styl` 来调整搜索框的默认颜色：

```stylus
// 你现在看到的这个搜索栏的颜色：
$accentColor = #3eaf7c
$textColor = #2c3e50
$borderColor = #eaecef
$codeBgColor = #282c34
$arrowBgColor = #ccc
```







